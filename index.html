<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Prompt:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
<title>รายการถอนล่าสุด (Real-time TH)</title>
<style>
  :root{
    --accent:#ff1e56; --ok:#35d07f; --wait:#ffcc66; --text:#111; --muted:#777;
    --card1: rgba(255,30,86,.08); --card2: rgba(255,30,86,.02); --border: rgba(255,30,86,.25);
  }
  html,body{
    margin:0;
    background:transparent;
    color:var(--text);
    font-family:"Kanit",system-ui,Segoe UI,Arial;
  }
  .wrap{max-width:720px;margin:14px auto;padding:0 12px}
  .title{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;border:2px solid rgba(255,30,86,.55);border-radius:12px;font-weight:600;color: white}
  .badge{font-size:12px;padding:4px 8px;border-radius:999px;background:#eee;border:1px solid #ddd;color:#555}
  ul{list-style:none;margin:10px 0 0;padding:0;display:grid;gap:8px}
  .item{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center;padding:10px 14px;border-radius:14px;background:linear-gradient(180deg,var(--card1),var(--card2));border:1px solid var(--border)}
  .logo{width:32px;height:32px;border-radius:10px;overflow:hidden}
  .logo img{width:100%;height:100%;object-fit:contain}
  .left{display:grid;gap:4px}
  .meta{font-size:12px;color:#C7C7C7}
  .amount{font-weight:800;font-size:18px;text-align:right;color:white}
  .status{font-size:12px;text-align:right}
  .ok{color:var(--ok)} .wait{color:var(--wait)}
  .footer{margin:10px 2px 6px;text-align:right;color:var(--muted);font-size:12px}
</style>
</head>
<body>
  <div class="wrap">
    <div class="title">
      <span>รายการถอนล่าสุด</span>
      <span class="badge">เวลาไทย (UTC+7)</span>
    </div>
    <ul id="list"></ul>
    <div class="footer">
      อัปเดตล่าสุด: <span id="updated">—</span>
    </div>
  </div>

<script>
/* ---------- CONFIG ---------- */
const BANK_LOGO = {
  BBL:  "https://img5.pic.in.th/file/secure-sv1/BBLac177c236cbf4fb2.png",
  GSB:  "https://img2.pic.in.th/pic/GSB25cee300987e8a94.png",
  KBANK:"https://img5.pic.in.th/file/secure-sv1/KBANK14ef3411180f0964.png",
  KTB:  "https://img2.pic.in.th/pic/KTB03d591f6d31668d5.png",
  SCB:  "https://img5.pic.in.th/file/secure-sv1/SCBcfe6b49e706bcaea.png"
};
const BANKS = Object.keys(BANK_LOGO);
const BASE_INTERVAL_MS = 1500;
const MAX_ITEMS = 5;

/* ---------- HELPERS ---------- */
const THB = n => Number(n).toLocaleString("th-TH",{style:"currency",currency:"THB",maximumFractionDigits:0});
const fmtTH = ts => new Date(ts).toLocaleString("th-TH",{timeZone:"Asia/Bangkok"});

function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min;}
function pick(a){return a[Math.floor(Math.random()*a.length)];}
function cryptoId(){
  const a=new Uint8Array(8);
  crypto.getRandomValues(a);
  return [...a].map(b=>b.toString(16).padStart(2,"0")).join("");
}

/* ---------- PHONE GENERATOR ---------- */
const usedPhones = new Set();
function randomPhone(){
  const prefixSets = [
    rand(90,99),
    rand(80,89),
    rand(60,69)
  ];
  const prefix = pick(prefixSets);
  let last4;
  let phone;
  do {
    last4 = rand(0,9999).toString().padStart(4,"0");
    phone = `0${prefix}-XXX-${last4}`;
  } while (usedPhones.has(phone));
  usedPhones.add(phone);
  if(usedPhones.size > 100) usedPhones.clear(); // reset if too many
  return phone;
}

/* ---------- STATE ---------- */
const listEl=document.getElementById("list");
const updatedEl=document.getElementById("updated");
let items=[];

/* ---------- RENDER ---------- */
function render(){
  listEl.innerHTML = items.map(it=>`
    <li class="item" id="row-${it.id}">
      <div class="logo"><img src="${BANK_LOGO[it.bank]}" alt="${it.bank}"></div>
      <div class="left">
        <div class="meta">${it.phone}</div>
        <div class="meta">${fmtTH(it.time)}</div>
      </div>
      <div>
        <div class="amount">${THB(it.amount)}</div>
        <div class="status ${it.status==='PAID'?'ok':'wait'}">${it.status==='PAID'?'✓ โอนแล้ว':'⏳ กำลังโอน'}</div>
      </div>
    </li>
  `).join('');
  updatedEl.textContent = new Date().toLocaleTimeString("th-TH",{timeZone:"Asia/Bangkok"});
}

/* ---------- LOGIC ---------- */
function pushRandomItem(){
  const it={
    id:cryptoId(),
    bank:pick(BANKS),
    phone:randomPhone(),
    amount:rand(500,18000),
    status:"PENDING",
    time:Date.now()
  };
  items.unshift(it);
  if(items.length>MAX_ITEMS) items=items.slice(0,MAX_ITEMS);
  render();
  setTimeout(()=>{
    it.status="PAID";
    const row=document.getElementById(`row-${it.id}`);
    if(row){
      const s=row.querySelector(".status");
      s.textContent="✓ โอนแล้ว";
      s.classList.remove("wait");
      s.classList.add("ok");
    }else render();
  },2500);
}
function loop(){
  pushRandomItem();
  setTimeout(loop,BASE_INTERVAL_MS+rand(0,1500));
}

/* ---------- START ---------- */
render();
loop();
</script>
</body>
</html>
